<!DOCTYPE html><html lang="zh-TW"><head><meta charset="utf-8"><title>MERN 專案STEP | HenRsの小窩</title><meta name="author" content="HenRs"><meta name="description" content="有關於『我』"><meta name="keywords" content=""><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><link rel="icon" href="/images/avatar.webp"><link rel="preconnect" href="https://s4.zstatic.net"><script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"><link rel="preconnect" href="https://fonts.googleapis.cn"><link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"><script>const mixins={}</script><script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script><script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"><script src="/js/lib/highlight.js"></script><script src="/js/lib/preview.js"></script><link rel="stylesheet" href="/css/main.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="layout"><transition name="fade"><div id="loading" v-show="loading"><div id="loading-circle"><h2>LOADING</h2><p>加載中···請稍後，如過慢請清理緩存</p><img src="/images/loading.gif"></div></div></transition><div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}"><nav id="desktop-menu"><a class="title" href="/"><span>HENRSの小窩</span> </a><a href="/"><i class="fa-solid fa-house fa-fw"></i> <span>&ensp;首頁</span> </a><a href="/about"><i class="fa-solid fa-id-card fa-fw"></i> <span>&ensp;關於</span> </a><a href="/archives"><i class="fa-solid fa-box-archive fa-fw"></i> <span>&ensp;項目</span> </a><a href="/categories"><i class="fa-solid fa-bookmark fa-fw"></i> <span>&ensp;類別</span> </a><a href="/tags"><i class="fa-solid fa-tags fa-fw"></i> <span>&ensp;標籤</span></a></nav><nav id="mobile-menu"><div class="title" @click="showMenuItems = !showMenuItems"><i class="fa-solid fa-bars fa-fw"></i> <span>&emsp;HENRSの小窩</span></div><transition name="slide"><div class="items" v-show="showMenuItems"><a href="/"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-house fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">首頁</div></div></a><a href="/about"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-id-card fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">關於</div></div></a><a href="/archives"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-box-archive fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">項目</div></div></a><a href="/categories"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-bookmark fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">類別</div></div></a><a href="/tags"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-tags fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">標籤</div></div></a></div></transition></nav></div><transition name="fade"><div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div></transition><div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'"><div class="article"><div><h1>MERN 專案STEP</h1></div><div class="info"><span class="date"><span class="icon"><i class="fa-solid fa-calendar fa-fw"></i> </span>2024/8/24</span></div><div class="content" v-pre><h3 id="8-在-component-的資料夾建立-registerjs-loginjs-profilejs-navjs"><a class="markdownIt-Anchor" href="#8-在-component-的資料夾建立-registerjs-loginjs-profilejs-navjs"></a> 8. 在 Component 的資料夾，建立 Register.js , login.js , profile.js, nav.js</h3><p><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/1410822048/My-storehouse@main/register-component.js">Register.js</a>   <a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/1410822048/My-storehouse@main/login-component.js">login.js</a>   <a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/1410822048/My-storehouse@main/profile-component.js">profile.js</a>   <a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/1410822048/My-storehouse@main/nav-component.js">nav.js</a></p><h3 id="9-將他們導入進-appjs-內"><a class="markdownIt-Anchor" href="#9-將他們導入進-appjs-內"></a> 9. 將他們導入進 App.js 內</h3><pre class="highlight"><code class="js">import Register from &quot;./components/register-component&quot;;
import Login from &quot;./components/login-component&quot;;
import Profile from &quot;./components/profile-component&quot;;

function App() &#123;
  return (
    &lt;BrowserRouter&gt;
      &lt;Routes&gt;
        &lt;Route path=&quot;/&quot; element=&#123;&lt;Layout /&gt;&#125;&gt;
          &lt;Route index element=&#123;&lt;Home /&gt;&#125; /&gt;
          &lt;Route path=&quot;register&quot; element=&#123;&lt;Register /&gt;&#125; /&gt;
          &lt;Route path=&quot;login&quot; element=&#123;&lt;Login /&gt;&#125; /&gt;
          &lt;Route path=&quot;profile&quot; element=&#123;&lt;Profile /&gt;&#125; /&gt;
        &lt;/Route&gt;
      &lt;/Routes&gt;
    &lt;/BrowserRouter&gt;
  );
&#125;
</code></pre><h1 id="建立前後端橋樑"><a class="markdownIt-Anchor" href="#建立前後端橋樑"></a> 建立前後端橋樑</h1><p> </p><h3 id="10-在-registerjs-內部-把-authservice-導入設置基本參數"><a class="markdownIt-Anchor" href="#10-在-registerjs-內部-把-authservice-導入設置基本參數"></a> 10. 在 Register.js 內部 把 auth.service 導入，設置基本參數</h3><pre class="highlight"><code class="JSX">import AuthService from &quot;../services/auth.service&quot;;
import &#123; useNavigate &#125; from &quot;react-router-dom&quot;;

const RegisterComponent = () =&gt; &#123;
  const Navigate = useNavigate();
  let [username, setUserName] = useState(&quot;&quot;);
  let [email, setEmail] = useState(&quot;&quot;);
  let [password, setPassword] = useState(&quot;&quot;);

  const HandleUsername = (e) =&gt; &#123;
    setUserName(e.target.value);
  &#125;;

  const HandleEmail = (e) =&gt; &#123;
    setEmail(e.target.value);
  &#125;;

  const HandlePassword = (e) =&gt; &#123;
    setPassword(e.target.value);
  &#125;;
  const handleRole = (e) =&gt; &#123;
    setRole(e.target.value);
  &#125;;

  const HandleRegister = async function () &#123;
    try &#123;
      await AuthService.register(username, email, password, role);
      Navigate(&quot;/login&quot;); // 跳轉到登入頁面
    &#125; catch (e) &#123;
      console.log(e)
    &#125;
  &#125;;
&#125;
</code></pre><p>將註解的 OnChange 取消，並設置 btn 的 OnClick</p><pre class="highlight"><code class="HTML">&lt;!-- 取消註解 --&gt;
onChange=&#123;HandleUsername&#125;
onChange=&#123;HandleEmail&#125;
onChange=&#123;HandlePassword&#125;
onChange=&#123;handleRole&#125;

&lt;!-- 設置OnClick--&gt;
&lt;button onClick=&#123;HandleRegister&#125;&gt; &lt;/button&gt;
</code></pre><h3 id="11-在-loginjs-內部設置基本參數"><a class="markdownIt-Anchor" href="#11-在-loginjs-內部設置基本參數"></a> 11. 在 login.js 內部，設置基本參數</h3><pre class="highlight"><code class="JSX">const LoginComponent = () =&gt; &#123;
  const Navigate = useNavigate();
  let [email, setEmail] = useState(&quot;&quot;);
  let [password, setPassword] = useState(&quot;&quot;);

  const handleEmailChange = (e) =&gt; setEmail(e.target.value);
  const handlePasswordChange = (e) =&gt; setPassword(e.target.value);

  const HandleLogin = async function () &#123;
    try &#123;
      let response = await AuthService.login(email, password);
      localStorage.setItem(&quot;user&quot;, JSON.stringify(response.data));
      setCurrentUser(AuthService.getCurrentUser());
      Navigate(&quot;/profile&quot;); // 跳轉到登入頁面
    &#125; catch (e) &#123;
      console.log(e.response);
    &#125;
  &#125;
&#125;
</code></pre><p>將註解的 OnChange 取消，並設置 btn 的 OnClick</p><pre class="highlight"><code class="HTML">&lt;!-- 取消註解 --&gt;
onChange=&#123;handleEmailChange&#125;
onChange=&#123;handlePasswordChange&#125;

&lt;!-- 設置OnClick--&gt;
&lt;button  onClick=&#123;HandleLogin&#125;&gt; &lt;/button&gt;
</code></pre><h3 id="12-在-profilejs-內部把-authservice-導入並設置基本參數設置基本參數"><a class="markdownIt-Anchor" href="#12-在-profilejs-內部把-authservice-導入並設置基本參數設置基本參數"></a> 12. 在 profile.js 內部把 auth.service 導入，並設置基本參數設置基本參數</h3><pre class="highlight"><code class="JSX">import &#123; useState, useEffect &#125; from &quot;react&quot;;
import AuthService from &quot;../services/auth.service&quot;;

const ProfileComponent = () =&gt; &#123;
  const [username, setUsername] = useState(&quot;&quot;); // 用户名
  const [password, setPassword] = useState(&quot;&quot;); // 密碼

  useEffect(() =&gt; &#123;
    const user = AuthService.getCurrentUser();
    if (user) &#123;
      setCurrentUser(user);
    &#125;
  &#125;, [setCurrentUser]);
&#125;
</code></pre><h3 id="13-將-profilejs-內部的-usestate-更改到全局"><a class="markdownIt-Anchor" href="#13-將-profilejs-內部的-usestate-更改到全局"></a> 13. 將 profile.js 內部的 useState 更改到全局</h3><p>刪除這行</p><pre class="highlight"><code class="JSX">let [ currentUser, setCurrentUser ] = props;

</code></pre><p>將他更改到 App.js ，並導入 auth.service</p><pre class="highlight"><code class="JSX">import &#123; useState &#125; from &quot;react&quot;;
import AuthService from &quot;./services/auth.service&quot;;

let [currentUser, setCurrentUser] = useState(AuthService.getCurrentUser());
</code></pre><p>更改至全局，並傳入 currentUser 參數</p><pre class="highlight"><code class="JSX">function App() &#123;
  let [currentUser, setCurrentUser] = useState(AuthService.getCurrentUser());
  return (
    &lt;BrowserRouter&gt;
      &lt;Routes&gt;
        &lt;Route
          path=&quot;/&quot;
          element=&#123;
            &lt;Layout currentUser=&#123;currentUser&#125; setCurrentUser=&#123;setCurrentUser&#125; /&gt;
          &#125;
        &gt;
          &lt;Route index element=&#123;&lt;Home /&gt;&#125;/&gt;
          &lt;Route path=&quot;register&quot;&gt;
            &lt;Route index element=&#123;&lt;Register /&gt;&#125; /&gt;
          &lt;/Route&gt;
          &lt;Route path=&quot;login&quot;&gt;
            &lt;Route
              index
              element=&#123;
                &lt;Login
                  currentUser=&#123;currentUser&#125;
                  setCurrentUser=&#123;setCurrentUser&#125;
                /&gt;
              &#125;
            /&gt;
          &lt;/Route&gt;
          &lt;Route path=&quot;profile&quot;&gt;
            &lt;Route
              index
              element=&#123;
                &lt;Profile
                  currentUser=&#123;currentUser&#125;
                  setCurrentUser=&#123;setCurrentUser&#125;
                /&gt;
              &#125;
            /&gt;
          &lt;/Route&gt;
  )
&#125;
</code></pre><h3 id="14-將傳入的-currentuser-放至-fc-內部當-props"><a class="markdownIt-Anchor" href="#14-將傳入的-currentuser-放至-fc-內部當-props"></a> 14. 將傳入的 currentUser 放至 fc 內部當 props</h3><p>例如</p><pre class="highlight"><code class="JSX">const Layout = (&#123; currentUser, setCurrentUser &#125;) =&gt; &#123;
  return (
    &lt;div&gt;
      &lt;Nav currentUser=&#123;currentUser&#125; setCurrentUser=&#123;setCurrentUser&#125; /&gt;
      &lt;main&gt;
        &lt;Outlet /&gt;
      &lt;/main&gt;
    &lt;/div&gt;
  );
&#125;;
</code></pre><p> <br> </p><p class="centerP"><strong>恭喜完成全部設定</strong></p><p> <br> </p><div class="pagination"><a href="#" class="page-link" data-page-prefix="MERN" data-page="1">1 </a><a href="#" class="page-link" data-page-prefix="MERN" data-page="2">2 </a><a href="#" class="page-link" data-page-prefix="MERN" data-page="3">3</a></div></div></div><footer id="footer"><div id="footer-wrap"><div>&copy; 2024 - 2025 HenRsの小窩 <span id="footer-icon"><i class="fa-solid fa-font-awesome fa-fw"></i> </span>&commat;HenRs</div><div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp; <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a></div></div></footer></div><transition name="fade"><div id="preview" ref="preview" v-show="previewShow"><img id="preview-content" ref="previewContent"></div></transition></div><script src="/js/main.js" defer></script><canvas id="fireworks" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:32767"></canvas><script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js"></script><script src="/js/fireworks.min.js" defer></script><script src="/js/commonpage.min.js" defer></script></body></html>